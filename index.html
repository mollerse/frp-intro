<!doctype html>
<html lang="en">

    <head>
        <meta charset="utf-8">

        <title>Intro til FRP</title>

        <link rel="stylesheet" href="./css/reveal.min.css">
        <link rel="stylesheet" href="./css/theme/night.css">
        <link rel="stylesheet" href="./css/main.css">
        <link rel="stylesheet" href="./css/vote-example.css">
        <link rel="stylesheet" href="./css/monokai-sublime.css">


        <script type="text/javascript" src="js/jquery.js"></script>
        <script type="text/javascript" src="js/bacon.js"></script>
        <script type="text/javascript" src="/socket.io/socket.io.js"></script>
    </head>

    <body>

        <div class="reveal">

            <div class="slides">

                <section>
                    <h2>Introduksjon til Functional Reactive Programming (FRP)</h2>
                    <p>BEKK Fagdag</p>
                    <p>Stian Veum Møllersen / <a href="http://twitter.com/mollerse">@mollerse</a></p>
                    <p>Mikael Brevik / <a href="http://twitter.com/mikaelbrevik">@mikaelbrevik</a></p>
                    <p><a href="http://open.bekk.no">open.bekk.no</a></p>
                </section>

                <section>
                    <h2>Agenda</h2>
                    <ol>
                        <li>Teoretisk introduksjon</li>
                        <li>FRP i front-end</li>
                        <li>Bacon.js</li>
                        <li>Praktiske eksempler og demo</li>
                    </ol>
                </section>

                <section>
                    <h3>Hva er Functional Reactive Programming?</h3>
                    <p>Kombinasjonen mellom to paradigmer:</p>
                    <ol>
                    <li>Funksjonell programmering</li>
                    <li>Reaktiv programmering</li>
                    </ol>
                </section>

                <section>
                    <section><h2>Funksjonell programmering</h2></section>
                    <section>
                        <h3>En deklarativ programmeringsparadigme med funksjoner i fokus.</h3>
                        <h4>Unngår tilstander og mutable objekter.</h4>
                    </section>
                    <section>
                        <h4>Deklarativ programmering forklarer hva som skjer.</h4>
                        <h4>Imperativ programmering forklarer hvordan det skal skje!</h4>
                    </section>
                    <section>
                        <h3>Unngår uønskede bieffekter</h3>
                    </section>
                    <section>
                        <h3>Vanlig med bruk av blant annet <code>map</code>, <code>reduce</code> og <code>filter</code>.</h3>
                        <h4>Eksempler på språk kan være Lisp, Haskell, Scala, men også JavaScript</h4>
                    </section>
                </section>
                <section>
                    <section><h2>Reaktiv programmering</h2></section>
                    <section>
                        <h3>Kan beskrives som en metode for å holde systemet kontinuerlig oppdatert med omgivelsene.</h3>
                    </section>
                    <section>
                        <h3>En måte for data å reagere på endringer og oppdatere for å reflektere disse endringene.</h3>
                    </section>
                    <section>
                        <h3>Et eksempel på reaktiv data kan være et regneark og summen av to tall.</h3>
                    </section>
                    <section>

                        <div class="dataflow-example">
                            <input type="number" id="a" value="3" class="node-a"/>
                            <input type="number" id="b" value="2" class="node-b"/>
                            <input type="text" id="sum" value="0" disabled="" class="node-result"/>
                        </div>

                        <script>
                            (function () {
                                var _add = function (a, b) { return a + b; },
                                    _value = function (e) { return e.currentTarget.value; },
                                    getInputAsProperty = function (id) {
                                        var $el = $(id);
                                        return $el.asEventStream("change")
                                                  .map(_value)
                                                  .toProperty($el.val())
                                                  .map(Number);
                                    };

                                var $a = getInputAsProperty("#a"),
                                    $b = getInputAsProperty("#b");

                                $a.combine($b, _add).assign($("#sum"), "val");
                            })();
                        </script>
                    </section>
                </section>

                <section>
                    <section><h2>Funksjonell Reaktiv Programmering</h2></section>
                    <section>
                        <h3>To generelle konsepter</h3>
                        <ol>
                            <li>Behaviours (Adferd)</li>
                            <li>Events (Hendelse)</li>
                        </ol>
                    </section>
                    <section>
                        <h3>Adferder</h3>
                        <p>En kontinuerlig verdi. Eksemeplvis klokken, høyde eller vektorgrafikk.</p>
                    </section>
                    <section>
                        <h3>Hendelser</h3>
                        <p>En diskret verdi. Eksempelvis muse-klikk eller en mengde.</p>
                    </section>
                    <section>
                        <h3>I FRP blir hendelser og adferder behandlet som sekvenser og kan bli håndtert på en funksjonell måte.</h3>
                    </section>
                </section>

                <section><h1>STIAN SIN DEL</h1></section>


                <section class="vote-example">
                    <section><h2>Eksempel med WebSockets og flere klienter.</h2></section>
                    <section><h3>Vi skal lage et enkelt system for spørreundersøkelser basert på WebSockets.</h3></section>
                    <section>
                        <pre><code data-trim>var socketStream =
    Bacon.fromEventTarget(socket, "vote")</code></pre>
                    </section>
                    <section>
                        <pre><code data-trim>var totalVoteProperty = function (id) {</code></pre>
                        <pre class="fragment"><code>    return socketStream</code></pre>
                        <pre class="fragment"><code>        .filter(_isId(id))</code></pre>
                        <pre class="fragment"><code>        .map(1)</code></pre>
                        <pre class="fragment"><code>        .scan(0, _add);</code></pre>
                        <pre><code>};</code></pre>
                    </section>

                    <section>

                        <pre><code data-trim>var percentage = function (stream, total) {</code></pre>
                        <pre><code class="fragment">    return stream</code></pre>
                        <pre><code class="fragment">            .combine(total, _toPercentage);</code></pre>
                        <pre><code data-trim>};</code></pre>
                    </section>

                    <section>
                        <pre><code data-trim>var sum = socketStream.map(1).scan(0, _add);</code></pre>
                    </section>

                    <section>
                        <pre><code data-trim>[1, 2, 3].forEach(function (id) {</code></pre>
                        <pre><code class="fragment" data-fragment-index="1">  return percentage(</code></pre>
                        <pre><code class="fragment" data-fragment-index="1">    totalVoteProperty("alt" + id), sum)</code></pre>
                        <pre><code class="fragment">        .assign($("#alt" + id), "val");</code></pre>
                        <pre><code data-trim>});</code></pre>
                    </section>

                    <section><h2>Demo</h2></section>

                    <section>
                        <h3>Her er det et spørsmål som er stilt, og det kan potensielt være langt?</h3>
                        <progress max="100" id="alt1" value="0" data-skill="Ett alternativ her" class="progress-red"></progress>
                        <progress max="100" id="alt2" value="0" data-skill="Et annet alternativ som er lengre" class="progress-yellow"></progress>
                        <progress max="100" id="alt3" value="0" data-skill="Noe slags opplegg her og..." class="progress-green"></progress>

                        <h4>Avgi din stemme på: <a href="#">bit.ly/NOEHER</a></h4>

                        <script>
                        (function () {
                            var socket = new io.connect(),
                                socketStream = Bacon.fromEventTarget(socket, "vote"),
                                _isId = function (id) {
                                    return function (data) {
                                        return data === id;
                                    };
                                },
                                _add = function (a, b) {
                                    return a + b;
                                },
                                _toPercentage = function (value, sum) {
                                    return sum === 0 ? 0 : (value / sum) * 100;
                                };

                            var totalVoteProperty = function (id) {
                                return socketStream.filter(_isId(id)).map(1).scan(0, _add);
                            };

                            var percentage = function (stream, total) {
                                return stream.combine(total, _toPercentage);
                            };

                            var sum = socketStream.map(1).scan(0, _add);

                            [1, 2, 3].forEach(function (id) {
                                percentage(totalVoteProperty("alt" + id), sum)
                                    .assign($("#alt" + id), "val");
                            });
                        }());
                        </script>
                    </section>
                </section>

                <section>
                    <section><h2>Takk for oss!</h2></section>
                    <section><h1>Spørsmål?</h1></section>
                </section>
            </div>

        </div>

        <script src="./lib/js/head.min.js"></script>
        <script src="./js/reveal.min.js"></script>

        <script>

            Reveal.initialize({
                controls: true,
                progress: true,
                history: true,
                center: true,
                dependencies: [
                    { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; }},
                    { src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } },
                    { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
                    ]
            });

        </script>

    </body>
</html>
